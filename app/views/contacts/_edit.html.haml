.remote
  - remote_form_for(@contact) do |f|
    = hidden_field_tag "opportunity", "#{@opportunity.id if @opportunity}"
    = f.hidden_field :user_id
    = f.hidden_field :assigned_to
    = f.error_messages
    = render :partial => "contacts/top_section", :locals => { :f => f }
    = render :partial => "contacts/extra",       :locals => { :f => f }
    = render :partial => "contacts/web",         :locals => { :f => f }
    = render :partial => "contacts/permissions", :locals => { :f => f }
    .buttonbar
      = f.submit "Save Contact", :onclick => %/$("contact_assigned_to").value = $F("account_assigned_to")/
      or
      = link_to_remote("Cancel", :url => edit_contact_path(@contact), :method => :get, :with => "{ cancel: true }")

%script{:type => "text/javascript"}
  = @account.id.blank? ? "crm.create_account();" : "crm.select_account();"
